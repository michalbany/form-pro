# Formense

## Napady
### Přihlašování a Autentizace
Na přihlášení a registraci bude pouze jeden odkaz, který bude obsahovat jeden textový input. Tento textový input bude představovat možnost přihlášení přes `marfId`. Marf ID může být generovaný token nebo email, který končí na *@marf.cz*.  
 Pokud se jedná o token uživatel bude ověřen pokud tento token existuje v databázi. S expirací a správou tokenů se bude manipulovat samostatně a nebude to součástí přihlašování.  
  Pro autentizaci přes Marf email to bude trochu složitější. Účet nemusí existovat. Po tom, co uživatel zadá `email@marf.cz` se zkontroluje jestli exituje učet s tímto emailem. Pokud ne, odešle se ověřovací odkaz na tuto emailovou adresu a po potvrzení se tento účet vytvoří. Zároveň se vytvoří relační token, který se odešle na klienskou stranu a uloží se do cookies. Potom, co se uživatel bude chtít znovu přihlásit se zkontoroluje jestli existuje správný relační token spojený s tímto emailem na straně klienta. Zkontrolují se také další požadavky, které by mohly ohrozit přístup. Například jiná IP adresa a další atributy relace. Pokud se ukáže, že se jedná o stejné zařízení a jsou validní všechny relační atributy uživatel bude přihlášený bez hesla. Pokud některá z těchto možností selže dojde k vypršení relačního tokenu. To způsobí, že se uživatel nebude moci přihlásit bez hesla a bude nutné znovu přihlášení prostřednictvám ověření přes email.